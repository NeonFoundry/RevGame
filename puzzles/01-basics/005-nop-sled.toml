[metadata]
id = "basic-005"
title = "NOP Sled"
difficulty = 1
category = "patching"
tags = ["nop", "multiple-patch", "beginner"]
estimated_time_minutes = 7
prerequisites = ["basic-001", "basic-002"]

[description]
brief = "Learn to NOP out multiple instructions"
detailed = """
This program has two separate checks that both fail.
You've learned about NOPs - now use multiple NOPs to skip
both the CMP and JNE instructions!

Remember:
- CMP EAX, imm32 is 5 bytes (3D XX XX XX XX)
- JNE rel8 is 2 bytes (75 XX)

You'll need to patch 7 bytes total to skip the first check entirely.
"""

[setup]
memory_size = 16384
code_start = 0x1000
data_start = 0x2000
stack_start = 0x3000

[setup.registers]
eax = 0xBEEF
esp = 0x3000

[setup.code]
# Assembly:
#   0x1000: cmp eax, 0x1337      ; 3D 37 13 00 00 - First check (fails)
#   0x1005: jne fail             ; 75 07         - Jump to fail
#   0x1007: mov eax, 1           ; B8 01 00 00 00 - Success
#   0x100C: jmp end              ; EB 05
#   0x100E: fail: mov eax, 0     ; B8 00 00 00 00 - Failure
#   0x1013: end: hlt             ; F4
bytes = "3D 37 13 00 00 75 07 B8 01 00 00 00 EB 05 B8 00 00 00 00 F4"
entry_point = 0

[validation]
type = "register_value"
register = "eax"
expected = 1

[hints]
level1 = "You need to skip both the CMP (5 bytes) and JNE (2 bytes) instructions."
level2 = "NOP (0x90) can fill any space. Use 7 NOPs to replace both instructions."
level3 = "Patch all 7 bytes: patch 0x1000 90 90 90 90 90 90 90"
